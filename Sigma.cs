using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Management.Automation.Runspaces;
using System.Management.Automation;
using System.Diagnostics.Eventing.Reader;
using System.Text.RegularExpressions;

namespace EDOCS
{
    class Sigma
    {

        public Dictionary<string, dynamic> sigmas = new Dictionary<string, dynamic>();
       
        Dictionary<string, string> evnt;
        public Sigma(EventLogRecord record) {
            string Key = record.Id.ToString();
            string Value = record.FormatDescription();
            this.evnt = new Dictionary<string, string>();
            this.evnt.Add(Key, Value);
         }
        public void InitBooleanMatrix()
        {

            sigmas["rules/windows/process_creation/win_apt_bluemashroom.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\regsvr32.*\\AppData\\Local\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\AppData\\Local\\.*,DllEntry.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_apt_mustangpanda.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"CommandLine.*.*Temp\\wtask.exe /create.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*%windir:~-3,1%%PUBLIC:~-9,1%.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/E:vbscript .* C:\\Users\\.*.txt"" /F", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/tn ""Security Script .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*%windir:~-1,1%.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Image.*.*Temp\\winwsh.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_attrib_hiding_files.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\attrib.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.* \+h .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((x.Key == "1" && (new Regex(@"CommandLine.*.*\\desktop.ini .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | (new Regex(@"ParentImage.*.*\\cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*\+R \+H \+S \+A \\.*.cui", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ParentCommandLine.*C:\\WINDOWS\\system32\\.*.bat", RegexOptions.IgnoreCase).IsMatch(x.Value)))))) select x;
            sigmas["rules/windows/process_creation/win_bypass_squiblytwo.yml"] = from x in evnt where (x.Key == "1" && (((new Regex(@"Image.*.*\\wmic.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*wmic .* .*format:\\""http.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*wmic .* /format:'http", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*wmic .* /format:http.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | ((new Regex(@"Imphash.*1B1A3F43BF37B5BFE60751F2EE2F326E", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Imphash.*37777A96245A3C74EB217308F3546F4C", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Imphash.*9D87C9D67CE724033C0B40CC4CA1B206", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* .*format:\\""http.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /format:'http", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /format:http.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/process_creation/win_change_default_file_association.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*cmd.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/c.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*assoc.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_cmdkey_recon.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\cmdkey.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.* /list .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_cmstp_com_object_access.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentCommandLine.*.*\\DllHost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"ParentCommandLine.*.*{3E5FC7F9-9A51-4367-9063-A120244FBEC7}", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentCommandLine.*.*{3E000D72-A845-4CD9-BD83-80C07C3B881F}", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_control_panel_item.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*.cpl", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"CommandLine.*.*\\System32\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*%System%.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_data_compressed_with_rar.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\rar.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.* a .*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*-r.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_encoded_frombase64string.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*OjpGcm9tQmFzZTY0U3RyaW5n.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*o6RnJvbUJhc2U2NFN0cmluZ.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*6OkZyb21CYXNlNjRTdHJpbm.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_encoded_iex.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*SUVYIChb.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*lFWCAoW.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*JRVggKF.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*aWV4IChb.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*lleCAoW.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*pZXggKF.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*aWV4IChOZX.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*lleCAoTmV3.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*pZXggKE5ld.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*SUVYIChOZX.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*lFWCAoTmV3.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*JRVggKE5ld.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_etw_trace_evasion.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* cl .*/Trace.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* clear-log .*/Trace.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* sl.* /e:false.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* set-log.* /e:false.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_exploit_cve_2015_1641.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\WINWORD.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\MicroScMgmt.exe ", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_exploit_cve_2017_0261.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\WINWORD.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\FLTLDR.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_exploit_cve_2017_11882.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\EQNEDT32.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_exploit_cve_2017_8759.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\WINWORD.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\csc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_exploit_cve_2019_1378.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentCommandLine.*.*\\cmd.exe /c C:\\Windows\\Setup\\Scripts\\SetupComplete.cmd", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentCommandLine.*.*\\cmd.exe /c C:\\Windows\\Setup\\Scripts\\PartnerSetupComplete.cmd", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Image.*C:\\Windows\\System32\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\SysWOW64\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\WinSxS\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\Setup\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_exploit_cve_2019_1388.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\consent.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\iexplore.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.* http.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"IntegrityLevel.*System", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_hack_rubeus.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* asreproast .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* dump /service:krbtgt .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* kerberoast .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* createnetonly /program:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* ptt /ticket:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /impersonateuser:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* renew /ticket:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* asktgt /user:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* harvest /interval:.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_hwp_exploits.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\Hwp.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\gbb.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_impacket_lateralization.yml"] = from x in evnt where (x.Key == "1" && (((new Regex(@"ParentImage.*.*\\wmiprvse.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\mmc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\explorer.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\services.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*cmd.exe.* /Q /c .* \\\\127.0.0.1\\.*&1.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | ((new Regex(@"ParentCommandLine.*.*svchost.exe -k netsvcs", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentCommandLine.*taskeng.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*cmd.exe /C .*Windows\\Temp\\.*&1", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/process_creation/win_install_reg_debugger_backdoor.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\CurrentVersion\\Image File Execution Options\\sethc.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\CurrentVersion\\Image File Execution Options\\utilman.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\CurrentVersion\\Image File Execution Options\\osk.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\CurrentVersion\\Image File Execution Options\\magnify.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\CurrentVersion\\Image File Execution Options\\narrator.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\CurrentVersion\\Image File Execution Options\\displayswitch.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_kernel_and_3rd_party_drivers_exploits_token_stealing.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentIntegrityLevel.*Medium", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"IntegrityLevel.*System", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_lethalhta.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_local_system_owner_account_discovery.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\whoami.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | (new Regex(@"Image.*.*\\wmic.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*useraccount.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*get.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Image.*.*\\quser.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\qwinsta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Image.*.*\\cmdkey.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/list.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Image.*.*\\cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/c.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*dir.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*\\Users\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | (x.Key == "1" && ((new Regex(@"Image.*.*\\net.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\net1.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"CommandLine.*.*user.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"CommandLine.*.*/domain.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/add.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/delete.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/active.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/expires.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/passwordreq.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/scriptpath.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/times.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/workstations.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))))) select x;
            sigmas["rules/windows/process_creation/win_mal_adwind.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\AppData\\Roaming\\Oracle.*\\java.*.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cscript.exe .*Retrive.*.vbs .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_mal_adwind_2.yml"] = from x in evnt where (x.Key == "11" && (new Regex(@"TargetFilename.*.*\\AppData\\Roaming\\Oracle\\bin\\java.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Retrive.*.vbs", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_mal_adwind_3.yml"] = from x in evnt where (x.Key == "13" && new Regex(@"TargetObject.*\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Details.*%AppData%\\Roaming\\Oracle\\bin\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_malware_dridex.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\svchost.exe C:\\Users\\.*\\Desktop\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | (new Regex(@"ParentImage.*.*\\svchost.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*whoami.exe /all", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*net.exe view", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/process_creation/win_malware_dtrack.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.* echo EEEE > .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_malware_emotet.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* -e.* PAA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*JABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQ.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*QAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*kAGUAbgB2ADoAdQBzAGUAcgBwAHIAbwBmAGkAbABlA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*IgAoACcAKgAnACkAOwAkA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*IAKAAnACoAJwApADsAJA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*iACgAJwAqACcAKQA7ACQA.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_malware_formbook.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentCommandLine.*C:\\Windows\\System32\\.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentCommandLine.*C:\\Windows\\SysWOW64\\.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* /c del ""C:\\Users\\.*\\AppData\\Local\\Temp\\.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /c del ""C:\\Users\\.*\\Desktop\\.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /C type nul > ""C:\\Users\\.*\\Desktop\\.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_malware_notpetya.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\AppData\\Local\\Temp\\.* \\.\\pipe\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | (new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*.dat,#1", RegexOptions.IgnoreCase).IsMatch(x.Value)) | new Regex(@".*\\perfc.dat.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_malware_qbot.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"ParentImage.*.*\\WinRAR.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | new Regex(@"CommandLine.*.* /c ping.exe -n 6 127.0.0.1 & type .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_malware_script_dropper.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* C:\\Users\\.*.jse .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\Users\\.*.vbe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\Users\\.*.js .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\Users\\.*.vba .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\Users\\.*.vbs .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\ProgramData\\.*.jse .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\ProgramData\\.*.vbe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\ProgramData\\.*.js .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\ProgramData\\.*.vba .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* C:\\ProgramData\\.*.vbs .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"ParentImage.*.*\\winzip.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_malware_wannacry.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\tasksche.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mssecsvc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\taskdl.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\@WanaDecryptor@.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\WanaDecryptor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\taskhsvc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\taskse.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\111.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\lhdfrgui.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\diskpart.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\linuxnew.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wannacry.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"CommandLine.*.*icacls .* /grant Everyone:F /T /C /Q.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*bcdedit /set {default} recoveryenabled no.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*wbadmin delete catalog -quiet.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*@Please_Read_Me@.txt.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_mavinject_proc_inj.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.* /INJECTRUNNING .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_mmc_spawn_shell.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\mmc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"Image.*.*\\cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\sh.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\bash.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\reg.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\BITSADMIN.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_mshta_spawn_shell.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"Image.*.*\\cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\sh.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\bash.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\reg.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\BITSADMIN.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_netsh_fw_add.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*netsh firewall add.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_netsh_packet_capture.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*netsh.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*trace.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*start.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_netsh_port_fwd_3389.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*netsh i.* p.*=3389 c.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_netsh_port_fwd.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*netsh interface portproxy add v4tov4 .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_network_sniffing.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\tshark.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*-i.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | new Regex(@"Image.*.*\\windump.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_office_shell.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\WINWORD.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\EXCEL.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\POWERPNT.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\MSPUB.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\VISIO.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\OUTLOOK.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Image.*.*\\cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\sh.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\bash.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\scrcons.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\schtasks.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\hh.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wmic.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\msiexec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\forfiles.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\scriptrunner.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mftrace.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\AppVLP.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_office_spawn_exe_from_users_directory.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\WINWORD.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\EXCEL.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\POWERPNT.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\MSPUB.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\VISIO.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\OUTLOOK.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Image.*C:\\users\\.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_plugx_susp_exe_locations.yml"] = from x in evnt where (x.Key == "1" && ((((((((((((new Regex(@"Image.*.*\\CamMute.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\Lenovo\\Communication Utility\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | (new Regex(@"Image.*.*\\chrome_frame_helper.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\Google\\Chrome\\application\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) | (new Regex(@"Image.*.*\\dvcemumanager.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\Microsoft Device Emulator\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) | (new Regex(@"Image.*.*\\Gadget.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\Windows Media Player\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) | (new Regex(@"Image.*.*\\hcc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\HTML Help Workshop\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) | (new Regex(@"Image.*.*\\hkcmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\System32\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\SysNative\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\SysWowo64\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) | (new Regex(@"Image.*.*\\Mc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\Microsoft Visual Studio.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Microsoft SDK.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows Kit.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) | (new Regex(@"Image.*.*\\MsMpEng.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\Microsoft Security Client\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows Defender\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\AntiMalware\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) | (new Regex(@"Image.*.*\\msseces.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\Microsoft Security Center\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Microsoft Security Client\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Microsoft Security Essentials\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) | (new Regex(@"Image.*.*\\OInfoP11.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\Common Files\\Microsoft Shared\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) | (new Regex(@"Image.*.*\\OleView.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\Microsoft Visual Studio.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Microsoft SDK.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows Kit.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows Resource Kit\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) | (new Regex(@"Image.*.*\\rc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\Microsoft Visual Studio.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Microsoft SDK.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows Kit.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows Resource Kit\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Microsoft.NET\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))))) select x;
            sigmas["rules/windows/process_creation/win_possible_applocker_bypass.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\msdt.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\installutil.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\regsvcs.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\regasm.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\msbuild.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\ieexec.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_powershell_amsi_bypass.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*System.Management.Automation.AmsiUtils.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*amsiInitFailed.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_powershell_b64_shellcode.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*AAAAYInlM.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*OiCAAAAYInlM.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*OiJAAAAYInlM.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_powershell_dll_execution.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Description.*.*Windows-Hostprozess \(Rundll32\).*", RegexOptions.IgnoreCase).IsMatch(x.Value))) && (new Regex(@"CommandLine.*.*Default.GetString.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*FromBase64String.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_powershell_download.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*new-object system.net.webclient\).downloadstring\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*new-object system.net.webclient\).downloadfile\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*new-object net.webclient\).downloadstring\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*new-object net.webclient\).downloadfile\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\Powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.* -windowstyle h ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -windowstyl h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -windowsty h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -windowst h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -windows h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -windo h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -wind h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -win h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -wi h", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -win h ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -win hi ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -win hid ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -win hidd ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -win hidde ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -NoPr ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -NoPro ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -NoProf ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -NoProfi ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -NoProfil ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -nonin ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -nonint ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -noninte ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -noninter ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -nonintera ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -noninterac ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -noninteract ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -noninteracti ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -noninteractiv ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -ec ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encodedComman ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encodedComma ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encodedComm ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encodedCom ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encodedCo ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encodedC ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encoded ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encode ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -encod ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -enco ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.* -en ", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_powershell_xor_commandline.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* -bxor.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_powersploit_empire_schtasks.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*schtasks.*/Create.*/SC .*ONLOGON.*/TN .*Updater.*/TR .*powershell.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*schtasks.*/Create.*/SC .*DAILY.*/TN .*Updater.*/TR .*powershell.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*schtasks.*/Create.*/SC .*ONIDLE.*/TN .*Updater.*/TR .*powershell.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*schtasks.*/Create.*/SC .*Updater.*/TN .*Updater.*/TR .*powershell.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_process_creation_bitsadmin_download.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\bitsadmin.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*/transfer", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_psexesvc_start.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ProcessCommandLine.*C:\\Windows\\PSEXESVC.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_query_registry.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\reg.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*currentVersion\\windows.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentVersion\\runServicesOnce.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentVersion\\runServices.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*winlogon\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentVersion\\shellServiceObjectDelayLoad.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentVersion\\runOnce.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentVersion\\runOnceEx.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentVersion\\run.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentVersion\\policies\\explorer\\run.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*currentcontrolset\\services.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_ransomware_shadowcopy.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*vssadmin delete shadows.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*wmic SHADOWCOPY DELETE.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_renamed_binary.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"OriginalFileName.*cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*powershell_ise.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*psexec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*psexec.c", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*wmic.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*certutil.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*cmstp.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*msiexec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*7z.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*winrar.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Image.*.*\\cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell_ise.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\psexec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\psexec64.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wmic.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\certutil.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cmstp.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\msiexec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\7z.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\winrar.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_renamed_paexec.yml"] = from x in evnt where (x.Key == "1" && (x.Key == "1" && (new Regex(@"Product.*.*PAExec.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Imphash.*11D40A7B7876288F919AB819CC2D9802", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Imphash.*6444f8a34e99b8f7d9647de66aabe516", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Imphash.*dfd6aa3f7b2b1035b76b718f1ddc689f", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Imphash.*1a6cca4d5460b1710a12dea39e4a592c", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"Image.*.*paexec.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_sdbinst_shim_persistence.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\sdbinst.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*.sdb.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_service_execution.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\net.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\net1.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"CommandLine.*.* start .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_shell_spawn_susp_program.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"ParentImage.*.*\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\wmiprvse.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Image.*.*\\schtasks.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\nslookup.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\certutil.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\bitsadmin.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"CurrentDirectory.*.*\\ccmcache\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_silenttrinity_stage_use.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Description.*.*st2stager.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_silenttrinity_stage_use_2.yml"] = from x in evnt where (x.Key == "7" && new Regex(@"Description.*.*st2stager.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_spn_enum.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\setspn.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Description.*.*Query or reset the computer.* SPN attribute.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"CommandLine.*.*-q.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_bcdedit.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"NewProcessName.*.*\\bcdedit.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"ProcessCommandLine.*.*delete.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ProcessCommandLine.*.*deletevalue.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ProcessCommandLine.*.*import.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_bginfo.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\bginfo.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/popup.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/nolicprompt.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_calc.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\calc.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | (x.Key == "1" && new Regex(@"Image.*.*\\calc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\Windows\\Sys.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/process_creation/win_susp_cdb.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\cdb.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*-cf.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_certutil_command.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* -decode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /decode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -decodehex .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /decodehex .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -urlcache .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /urlcache .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -verifyctl .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /verifyctl .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -encode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /encode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*certutil.* -URL.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*certutil.* /URL.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*certutil.* -ping.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*certutil.* /ping.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_certutil_encode.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*certutil -f -encode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*certutil.exe -f -encode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*certutil -encode -f .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*certutil.exe -encode -f .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_cli_escape.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*^h^t^t^p", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*h""t""t""p", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_cmd_http_appdata.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*cmd.exe /c .*http://.*%AppData%", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*cmd.exe /c .*https://.*%AppData%", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_codepage_switch.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*chcp.* 936", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*chcp.* 1258", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_compression_params.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"OriginalFileName.*7z.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*.*rar.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*.*Command.*Line.*RAR.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* -p.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -ta.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -tb.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -sdel.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -dw.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -hp.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"ParentImage.*C:\\Program.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_comsvcs_procdump.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*RUNDLL32.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*comsvcs.*MiniDump.*full.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*comsvcs.*MiniDumpW.*full.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_control_dll_load.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\System32\\control.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*\\rundll32.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"CommandLine.*.*Shell32.dll.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_csc_folder.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\csc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\Windows\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_csc.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\csc.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"ParentImage.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_devtoolslauncher.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\devtoolslauncher.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*LaunchForDeploy.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_dnx.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\dnx.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_double_extension.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*.doc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.docx.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.xls.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.xlsx.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.ppt.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.pptx.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.rtf.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.pdf.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*.txt.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*      .exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*______.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_dxcap.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\dxcap.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*-c.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_eventlog_clear.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\wevtutil.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*wevtutil.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* cl .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* clear-log .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* sl .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* set-log .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_exec_folder.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*C:\\PerfLogs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\$Recycle.bin\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Intel\\Logs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Users\\Default\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Users\\NetworkService\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\Fonts\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\Debug\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\Media\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\Help\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\addins\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\repair\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\security\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RSA\\MachineKeys\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\system32\\config\\systemprofile\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\Tasks\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\System32\\Tasks\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_execution_path_webserver.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\wwwroot\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wmpub\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\htdocs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Image.*.*bin\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Tools\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\SMSComponent\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"ParentImage.*.*\\services.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_execution_path.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\$Recycle.bin", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\All Users\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\Default\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Perflogs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\config\\systemprofile\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\Fonts\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\IME\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\addins\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_firewall_disable.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*netsh firewall set opmode mode=disable", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*netsh advfirewall set .* state off", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_fsutil_usage.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\fsutil.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*fsutil.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* deletejournal .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* createjournal .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_gup.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\GUP.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*C:\\Users\\.*\\AppData\\Local\\Notepad\+\+\\updater\\gup.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Users\\.*\\AppData\\Roaming\\Notepad\+\+\\updater\\gup.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Program Files\\Notepad\+\+\\updater\\gup.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Program Files \(x86\)\\Notepad\+\+\\updater\\gup.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_iss_module_install.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\APPCMD.EXE install module /name:.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_msiexec_cwd.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\msiexec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*C:\\Windows\\System32\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\SysWOW64\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\WinSxS\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_msiexec_web_install.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* msiexec.*://.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_msoffice.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\powerpnt.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\winword.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\excel.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"CommandLine.*.*http.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_net_execution.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\net.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\net1.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* group.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* localgroup.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* user.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* view.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* share", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* accounts.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* use.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* stop .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_ntdsutil.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*\\ntdsutil.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_odbcconf.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\odbcconf.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*-f.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*regsvr.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | (new Regex(@"ParentImage.*.*\\odbcconf.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_openwith.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\OpenWith.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/c.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_outlook_temp.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\Temporary Internet Files\\Content.Outlook\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_outlook.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*EnableUnsafeClientMailRules.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | (new Regex(@"ParentImage.*.*\\outlook.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*\\\\.*\\.*.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_ping_hex_ip.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\ping.exe 0x.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\ping 0x.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_powershell_empire_launch.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* -NoP -sta -NonI -W Hidden -Enc .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -noP -sta -w 1 -enc .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -NoP -NonI -W Hidden -enc .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_powershell_empire_uac_bypass.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* -NoP -NonI -w Hidden -c $x=$\(\(gp HKCU:Software\\Microsoft\\Windows Update\).Update\).*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -NoP -NonI -c $x=$\(\(gp HKCU:Software\\Microsoft\\Windows Update\).Update\);.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_powershell_enc_cmd.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* -e JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e  JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e   JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e    JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e     JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e      JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -enc JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -enco JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -encodedcommand JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* BA^J e-", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e SUVYI.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e aWV4I.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e SQBFAFgA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e aQBlAHgA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -enc SUVYI.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -enc aWV4I.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -enc SQBFAFgA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -enc aQBlAHgA.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"CommandLine.*.* -ExecutionPolicy remotesigned .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_powershell_hidden_b64_cmd.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.* hidden .*", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*aXRzYWRtaW4gL3RyYW5zZmVy.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*JpdHNhZG1pbiAvdHJhbnNmZX.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*Yml0c2FkbWluIC90cmFuc2Zlc.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AGMAaAB1AG4AawBfAHMAaQB6AGUA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*JABjAGgAdQBuAGsAXwBzAGkAegBlA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*JGNodW5rX3Npem.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*RjaHVua19zaXpl.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*Y2h1bmtfc2l6Z.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*lPLkNvbXByZXNzaW9u.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*SU8uQ29tcHJlc3Npb2.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*Ty5Db21wcmVzc2lvb.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*lPLk1lbW9yeVN0cmVhb.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*SU8uTWVtb3J5U3RyZWFt.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*Ty5NZW1vcnlTdHJlYW.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*4ARwBlAHQAQwBoAHUAbgBrA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*5HZXRDaHVua.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AEcAZQB0AEMAaAB1AG4Aaw.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*LgBHAGUAdABDAGgAdQBuAGsA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*LkdldENodW5r.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*R2V0Q2h1bm.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*RIUkVBRF9JTkZPNj.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*SFJFQURfSU5GTzY0.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*VEhSRUFEX0lORk82N.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cmVhdGVSZW1vdGVUaHJlYW.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*NyZWF0ZVJlbW90ZVRocmVhZ.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*Q3JlYXRlUmVtb3RlVGhyZWFk.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*0AZQBtAG0AbwB2AGUA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*1lbW1vdm.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AGUAbQBtAG8AdgBlA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*bQBlAG0AbQBvAHYAZQ.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*bWVtbW92Z.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*ZW1tb3Zl.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_powershell_parent_combo.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"ParentImage.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"CurrentDirectory.*.*\\Health Service State\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_procdump.yml"] = from x in evnt where (x.Key == "1" && ((x.Key == "1" && (new Regex(@"CommandLine.*.* -ma .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.* lsass.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | (new Regex(@"CommandLine.*.* -ma ls.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_process_creations.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*vssadmin.exe delete shadows.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*vssadmin delete shadows.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*vssadmin create shadow /for=C:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*copy \\\\?\\GLOBALROOT\\Device\\.*\\windows\\ntds\\ntds.dit.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*copy \\\\?\\GLOBALROOT\\Device\\.*\\config\\SAM.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*reg SAVE HKLM\\SYSTEM .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*reg SAVE HKLM\\SAM .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* sekurlsa:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*net localgroup administrators .* /add", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*net group ""Domain Admins"" .* /ADD /DOMAIN", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*certutil.exe .*-urlcache.* http.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*certutil.exe .*-urlcache.* ftp.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*netsh advfirewall firewall .*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*attrib \+S \+H \+R .*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*schtasks.* /create .*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*schtasks.* /sc minute.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\Regasm.exe .*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\Regasm .*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\bitsadmin.* /transfer.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\certutil.exe .* -decode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\certutil.exe .* -decodehex .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\certutil.exe -ping .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*icacls .* /grant Everyone:F /T /C /Q", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* wmic shadowcopy delete .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* wbadmin.exe delete catalog -quiet.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\wscript.exe .*.jse", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\wscript.exe .*.js", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\wscript.exe .*.vba", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\wscript.exe .*.vbe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\cscript.exe .*.jse", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\cscript.exe .*.js", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\cscript.exe .*.vba", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\cscript.exe .*.vbe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\fodhelper.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*waitfor.*/s.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*waitfor.*/si persist.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*remote.*/s.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*remote.*/c.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*remote.*/q.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*AddInProcess.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /stext .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /scomma .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /stab .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /stabular .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /shtml .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /sverhtml .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /sxml .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_prog_location_process_starts.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\$Recycle.bin", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Perflogs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\Fonts\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\IME\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\addins\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\debug\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_ps_appdata.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.* /c powershell.*\\AppData\\Local\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /c powershell.*\\AppData\\Roaming\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_psr_capture_screenshots.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\Psr.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/start.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_rasdial_activity.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*rasdial", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_recon_activity.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*net group ""domain admins"" /domain", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*net localgroup administrators", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_regsvr32_anomalies.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ParentImage.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CommandLine.*.*/i:http.* scrobj.dll", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*/i:ftp.* scrobj.dll", RegexOptions.IgnoreCase).IsMatch(x.Value))) | (new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ParentImage.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"Image.*.*\\EXCEL.EXE", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*..\\..\\..\\Windows\\System32\\regsvr32.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_rundll32_activity.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\rundll32.exe.* url.dll,.*OpenURL .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\rundll32.exe.* url.dll,.*OpenURLA .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\rundll32.exe.* url.dll,.*FileProtocolHandler .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\rundll32.exe.* zipfldr.dll,.*RouteTheCall .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\rundll32.exe.* Shell32.dll,.*Control_RunDLL .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\rundll32.exe javascript:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* url.dll,.*OpenURL .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* url.dll,.*OpenURLA .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* url.dll,.*FileProtocolHandler .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* zipfldr.dll,.*RouteTheCall .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* Shell32.dll,.*Control_RunDLL .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* javascript:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.RegisterXLL.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_rundll32_by_ordinal.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*\\rundll32.exe .*,#.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_run_locations.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*:\\RECYCLER\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*:\\SystemVolumeInformation\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\Tasks\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\debug\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\fonts\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\help\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\drivers\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\addins\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\cursors\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\system32\\tasks\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_schtask_creation.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\schtasks.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.* /create .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_script_execution.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\wscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cscript.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*.jse", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.vbe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.js", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.vba", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_squirrel_lolbin.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\update.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*--processStart.*.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*--processStartAndWait.*.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*–createShortcut.*.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_sysprep_appdata.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\sysprep.exe .*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*sysprep.exe .*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_sysvol_access.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*\\SYSVOL\\.*\\policies\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_taskmgr_localsystem.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\taskmgr.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_taskmgr_parent.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\taskmgr.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\resmon.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mmc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\taskmgr.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_susp_tscon_localsystem.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Image.*.*\\tscon.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_tscon_rdp_redirect.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.* /dest:rdp-tcp:.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_susp_userinit_child.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\userinit.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"CommandLine.*.*\\netlogon\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"Image.*.*\\explorer.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_vssadmin_ntds_activity.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*vssadmin.exe Delete Shadows", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*vssadmin create shadow /for=C:", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*copy \\\\?\\GLOBALROOT\\Device\\.*\\windows\\ntds\\ntds.dit", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*copy \\\\?\\GLOBALROOT\\Device\\.*\\config\\SAM", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*vssadmin delete shadows /for=C:", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*reg SAVE HKLM\\SYSTEM ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*esentutl.exe /y /vss .*\\ntds.dit.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_whoami.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\whoami.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"OriginalFileName.*whoami.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_susp_wmi_execution.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\wmic.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*/NODE:.*process call create .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* path AntiVirusProduct get .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* path FirewallProduct get .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* shadowcopy delete .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_sysmon_driver_unload.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\fltmc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*unload.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*sys.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_system_exe_anomaly.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"Image.*.*\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\services.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\regsvr32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\spoolsv.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\lsass.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\smss.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\csrss.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\conhost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wininit.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\lsm.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\winlogon.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\explorer.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\taskhost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Image.*C:\\Windows\\System32\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\SysWow64\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\explorer.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\winsxs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/process_creation/win_termserv_proc_spawn.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentCommandLine.*.*\\svchost.exe.*termsvcs", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\rdpclip.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_vul_java_remote_debugging.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*transport=dt_socket,address=.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"CommandLine.*.*address=127.0.0.1.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*address=localhost.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_webshell_detection.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\apache.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\tomcat.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\w3wp.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\php-cgi.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\nginx.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\httpd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*whoami.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*net user .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*ping -n .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*systeminfo", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*&cd&echo.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cd /d.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_webshell_spawn.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\w3wp.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\httpd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\nginx.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\php-cgi.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Image.*.*\\cmd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\sh.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\bash.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_win10_sched_task_0day.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*schtasks.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/change.*/TN.*/RU.*/RP.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_wmi_backdoor_exchange_transport_agent.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\EdgeTransport.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_wmi_persistence_script_event_consumer.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*C:\\WINDOWS\\system32\\wbem\\scrcons.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ParentImage.*C:\\Windows\\System32\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_wmi_spwns_powershell.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\wmiprvse.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/process_creation/win_workflow_compiler.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\Microsoft.Workflow.Compiler.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/process_creation/win_xsl_script_processing.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"Image.*.*\\wmic.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CommandLine.*.*/format.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | new Regex(@"Image.*.*\\msxsl.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_account_backdoor_dcsync_rights.yml"] = from x in evnt where (x.Key == "5136" && new Regex(@"LDAPDisplayName.*ntSecurityDescriptor", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"Value.*.*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Value.*.*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_account_discovery.yml"] = from x in evnt where (x.Key == "4661" && (new Regex(@"ObjectType.*SAM_USER", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectType.*SAM_GROUP", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"ObjectName.*.*-512", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-502", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-500", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-505", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-519", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-520", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-544", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-551", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*-555", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*admin.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_admin_rdp_login.yml"] = from x in evnt where (x.Key == "4624" && new Regex(@"LogonType.*10", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"AuthenticationPackageName.*Negotiate", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"AccountName.*Admin-.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_admin_share_access.yml"] = from x in evnt where ((x.Key == "5140" && new Regex(@"ShareName.*Admin$", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"SubjectUserName.*.*$", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_alert_active_directory_user_control.yml"] = from x in evnt where (x.Key == "4704" && (new Regex(@"Message.*.*SeEnableDelegationPrivilege.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_alert_enable_weak_encryption.yml"] = from x in evnt where (x.Key == "4738" && (new Regex(@"Message.*.*DES.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Preauth.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Encrypted.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Message.*.*Enabled.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_alert_lsass_access.yml"] = from x in evnt where (x.Key == "1121" && new Regex(@"Path.*.*\\lsass.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_alert_mimikatz_keywords.yml"] = from x in evnt where (new Regex(@"Message.*.* mimikatz .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* mimilib .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* <3 eo.oe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* eo.oe.kiwi .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* privilege::debug .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* sekurlsa::logonpasswords .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* lsadump::sam .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* mimidrv.sys .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* p::d .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* s::l .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_alert_ruler.yml"] = from x in evnt where (((x.Key == "4776") && new Regex(@"Workstation.*RULER", RegexOptions.IgnoreCase).IsMatch(x.Value)) | ((x.Key == "4624" | x.Key == "4625") && new Regex(@"WorkstationName.*RULER", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_atsvc_task.yml"] = from x in evnt where (x.Key == "5145" && new Regex(@"ShareName.*\\.*\\IPC$", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"RelativeTargetName.*atsvc", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Accesses.*.*WriteData.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_av_relevant_match.yml"] = from x in evnt where ((new Regex(@"Message.*.*HTool.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Hacktool.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*ASP/Backdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*JSP/Backdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*PHP/Backdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Backdoor.ASP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Backdoor.JSP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Backdoor.PHP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Webshell.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Portscan.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Mimikatz.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*WinCred.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*PlugX.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Korplug.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Pwdump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Chopper.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*WmiExec.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Xscan.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Clearlog.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*ASPXSpy.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Message.*.*Keygen.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Crack.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/builtin/win_dcsync.yml"] = from x in evnt where (((x.Key == "4662" && (new Regex(@"Properties.*.*Replicating Directory Changes All.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Properties.*.*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"SubjectDomainName.*Window Manager", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !((new Regex(@"SubjectUserName.*NT AUTHORITY.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"SubjectUserName.*.*$", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/builtin/win_disable_event_logging.yml"] = from x in evnt where (x.Key == "4719" && new Regex(@"AuditPolicyChanges.*removed", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_GPO_scheduledtasks.yml"] = from x in evnt where (x.Key == "5145" && new Regex(@"ShareName.*\\.*\\SYSVOL", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"RelativeTargetName.*.*ScheduledTasks.xml", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Accesses.*.*WriteData.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_hack_smbexec.yml"] = from x in evnt where (x.Key == "7045" && new Regex(@"ServiceName.*BTOBTO", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ServiceFileName.*.*\\execute.bat", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_impacket_secretdump.yml"] = from x in evnt where (x.Key == "5145" && new Regex(@"ShareName.*\\.*\\ADMIN$", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"RelativeTargetName.*SYSTEM32\\.*.tmp", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_lm_namedpipe.yml"] = from x in evnt where ((x.Key == "5145" && new Regex(@"ShareName.*\\.*\\IPC$", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(x.Key == "5145" && new Regex(@"ShareName.*\\.*\\IPC$", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"RelativeTargetName.*atsvc", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*samr", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*lsarpc", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*winreg", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*netlogon", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*srvsvc", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*protected_storage", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*wkssvc", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*browser", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*netdfs", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/builtin/win_mal_creddumper.yml"] = from x in evnt where (((new Regex(@"Message.*.*WCE SERVICE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*WCESERVICE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*DumpSvc.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && ((x.Key == "7045") | x.Key == "4697")) | (x.Key == "16" && new Regex(@"HiveName.*.*\\AppData\\Local\\Temp\\SAM.*.dmp", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_mal_service_installs.yml"] = from x in evnt where (x.Key == "7045" && ((new Regex(@"ServiceName.*WCESERVICE", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*WCE SERVICE", RegexOptions.IgnoreCase).IsMatch(x.Value)) | new Regex(@"ServiceFileName.*.*\\PAExec.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceFileName.*winexesvc.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceFileName.*.*\\DumpSvc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*mssecsvc2.0", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceFileName.*.* net user .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | (new Regex(@"ServiceName.*pwdump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*gsecdump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*cachedump.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/builtin/win_mal_wceaux_dll.yml"] = from x in evnt where ((x.Key == "4656" | x.Key == "4658" | x.Key == "4660" | x.Key == "4663") && new Regex(@"ObjectName.*.*\\wceaux.dll", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_net_ntlm_downgrade.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"TargetObject.*.*SYSTEM\\.*ControlSet.*\\Control\\Lsa\\lmcompatibilitylevel", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*SYSTEM\\.*ControlSet.*\\Control\\Lsa\\NtlmMinClientSec", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*SYSTEM\\.*ControlSet.*\\Control\\Lsa\\RestrictSendingNTLMTraffic", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_net_ntlm_downgrade_2.yml"] = from x in evnt where (x.Key == "4657" && new Regex(@"ObjectName.*\\REGISTRY\\MACHINE\\SYSTEM\\.*ControlSet.*\\Control\\Lsa", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"ObjectValueName.*LmCompatibilityLevel", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectValueName.*NtlmMinClientSec", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectValueName.*RestrictSendingNTLMTraffic", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_overpass_the_hash.yml"] = from x in evnt where (x.Key == "4624" && new Regex(@"LogonType.*9", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"LogonProcessName.*seclogo", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"AuthenticationPackageName.*Negotiate", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_pass_the_hash_2.yml"] = from x in evnt where ((x.Key == "4624" && ((new Regex(@"SubjectUserSid.*S-1-0-0", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"LogonType.*3", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"LogonProcessName.*NtLmSsp", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"KeyLength.*0", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"LogonType.*9", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"LogonProcessName.*seclogo", RegexOptions.IgnoreCase).IsMatch(x.Value)))) && !(new Regex(@"AccountName.*ANONYMOUS LOGON", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_pass_the_hash.yml"] = from x in evnt where ((new Regex(@"LogonType.*3", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"LogonProcessName.*NtLmSsp", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"WorkstationName.*%Workstations%", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ComputerName.*%Workstations%", RegexOptions.IgnoreCase).IsMatch(x.Value) && (x.Key == "4624" | x.Key == "4625")) && !(new Regex(@"AccountName.*ANONYMOUS LOGON", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_rdp_bluekeep_poc_scanner.yml"] = from x in evnt where (x.Key == "4625" && new Regex(@"AccountName.*AAAAAAA", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_rdp_localhost_login.yml"] = from x in evnt where (x.Key == "4624" && new Regex(@"LogonType.*10", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"SourceNetworkAddress.*::1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"SourceNetworkAddress.*127.0.0.1", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_rdp_potential_cve-2019-0708.yml"] = from x in evnt where ((x.Key == "56" | x.Key == "50") && new Regex(@"Source.*TermDD", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_rdp_reverse_tunnel.yml"] = from x in evnt where (x.Key == "5156" && ((new Regex(@"SourcePort.*3389", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"DestinationAddress.*127..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationAddress.*::1", RegexOptions.IgnoreCase).IsMatch(x.Value))) | (new Regex(@"DestinationPort.*3389", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"SourceAddress.*127..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"SourceAddress.*::1", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/builtin/win_susp_add_domain_trust.yml"] = from x in evnt where x.Key == "4706" select x;
            sigmas["rules/windows/builtin/win_susp_add_sid_history.yml"] = from x in evnt where ((x.Key == "4765" | x.Key == "4766") | (x.Key == "4738" && !((new Regex(@"SidHistory.*-", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"SidHistory.*%%1793", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/builtin/win_susp_backup_delete.yml"] = from x in evnt where (x.Key == "524" && new Regex(@"Source.*Backup", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_susp_codeintegrity_check_failure.yml"] = from x in evnt where (x.Key == "5038" | x.Key == "6281") select x;
            sigmas["rules/windows/builtin/win_susp_dhcp_config_failed.yml"] = from x in evnt where ((x.Key == "1031" | x.Key == "1032" | x.Key == "1034") && new Regex(@"Source.*Microsoft-Windows-DHCP-Server", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_susp_dhcp_config.yml"] = from x in evnt where x.Key == "1033" select x;
            sigmas["rules/windows/builtin/win_susp_dns_config.yml"] = from x in evnt where (x.Key == "150" | x.Key == "770") select x;
            sigmas["rules/windows/builtin/win_susp_dsrm_password_change.yml"] = from x in evnt where x.Key == "4794" select x;
            sigmas["rules/windows/builtin/win_susp_eventlog_cleared.yml"] = from x in evnt where (x.Key == "104" && new Regex(@"Source.*Microsoft-Windows-Eventlog", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_susp_failed_logon_reasons.yml"] = from x in evnt where ((x.Key == "4625" | x.Key == "4776") && (new Regex(@"Status.*0xC0000072", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Status.*0xC000006F", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Status.*0xC0000070", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Status.*0xC0000413", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Status.*0xC000018C", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Status.*0xC000015B", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_interactive_logons.yml"] = from x in evnt where (((x.Key == "528" | x.Key == "529" | x.Key == "4624" | x.Key == "4625") && new Regex(@"LogonType.*2", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"ComputerName.*%ServerSystems%", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ComputerName.*%DomainControllers%", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"LogonProcessName.*Advapi", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ComputerName.*%Workstations%", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_kerberos_manipulation.yml"] = from x in evnt where ((x.Key == "675" | x.Key == "4768" | x.Key == "4769" | x.Key == "4771") && (new Regex(@"FailureCode.*0x9", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0xA", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0xB", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0xF", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x10", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x11", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x13", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x14", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x1A", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x1F", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x21", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x22", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x23", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x24", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x26", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x27", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x28", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x29", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x2C", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x2D", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x2E", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x2F", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x31", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x32", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x3E", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x3F", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x40", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x41", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x43", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FailureCode.*0x44", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_lsass_dump.yml"] = from x in evnt where (x.Key == "4656" && new Regex(@"ProcessName.*C:\\Windows\\System32\\lsass.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"AccessMask.*0x705", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ObjectType.*SAM_DOMAIN", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_susp_mshta_execution.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"CommandLine.*.*mshta vbscript:CreateObject\(""Wscript.Shell""\).*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*mshta vbscript:Execute\(""Execute.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*mshta vbscript:CreateObject\(""Wscript.Shell""\).Run\(""mshta.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | ((new Regex(@"Image.*C:\\Windows\\system32\\mshta.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*.jpg.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.png.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.lnk.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.xls.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.doc.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.zip.*", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/builtin/win_susp_msmpeng_crash.yml"] = from x in evnt where (((new Regex(@"Source.*Application Error", RegexOptions.IgnoreCase).IsMatch(x.Value) && x.Key == "1000") | (new Regex(@"Source.*Windows Error Reporting", RegexOptions.IgnoreCase).IsMatch(x.Value) && x.Key == "1001")) && (new Regex(@"Message.*.*MsMpEng.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*mpengine.dll.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_net_recon_activity.yml"] = from x in evnt where (x.Key == "4661" && new Regex(@"AccessMask.*0x2d", RegexOptions.IgnoreCase).IsMatch(x.Value) && ((new Regex(@"ObjectType.*SAM_USER", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ObjectName.*S-1-5-21-.*-500", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"ObjectType.*SAM_GROUP", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ObjectName.*S-1-5-21-.*-512", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/builtin/win_susp_ntlm_auth.yml"] = from x in evnt where (x.Key == "8002" && new Regex(@"CallingProcessName.*.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_susp_psexec.yml"] = from x in evnt where ((x.Key == "5145" && new Regex(@"ShareName.*\\.*\\IPC$", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"RelativeTargetName.*.*-stdin", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*-stdout", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*-stderr", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(x.Key == "5145" && new Regex(@"ShareName.*\\.*\\IPC$", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"RelativeTargetName.*PSEXESVC.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_raccess_sensitive_fext.yml"] = from x in evnt where ((x.Key == "5145") && (new Regex(@"RelativeTargetName.*.*.pst", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.ost", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.msg", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.nst", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.oab", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.edb", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.nsf", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.bak", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.dmp", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.kirbi", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*\\ntds.dit", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*\\groups.xml", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"RelativeTargetName.*.*.rdp", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_rc4_kerberos.yml"] = from x in evnt where ((x.Key == "4769" && new Regex(@"TicketOptions.*0x40810000", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TicketEncryptionType.*0x17", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"ServiceName.*$.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_rottenpotato.yml"] = from x in evnt where (x.Key == "4624" && new Regex(@"LogonType.*3", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TargetUserName.*ANONYMOUS_LOGON", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"WorkstationName.*-", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"SourceNetworkAddress.*127.0.0.1", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_susp_sam_dump.yml"] = from x in evnt where (x.Key == "16" && (new Regex(@"Message.*.*\\AppData\\Local\\Temp\\SAM-.*.dmp .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_sdelete.yml"] = from x in evnt where ((x.Key == "4656" | x.Key == "4663" | x.Key == "4658") && (new Regex(@"ObjectName.*.*.AAA", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ObjectName.*.*.ZZZ", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_susp_security_eventlog_cleared.yml"] = from x in evnt where (x.Key == "517" | x.Key == "1102") select x;
            sigmas["rules/windows/builtin/win_susp_time_modification.yml"] = from x in evnt where (x.Key == "4616" && !(((new Regex(@"ProcessName.*C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ProcessName.*C:\\Windows\\System32\\VBoxService.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"ProcessName.*C:\\Windows\\System32\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"SubjectUserSid.*S-1-5-19", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/builtin/win_susp_wmi_login.yml"] = from x in evnt where (x.Key == "4624" && new Regex(@"ProcessName.*.*\\WmiPrvSE.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_svcctl_remote_service.yml"] = from x in evnt where (x.Key == "5145" && new Regex(@"ShareName.*\\.*\\IPC$", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"RelativeTargetName.*svcctl", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Accesses.*.*WriteData.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/builtin/win_usb_device_plugged.yml"] = from x in evnt where (x.Key == "2003" | x.Key == "2100" | x.Key == "2102") select x;
            sigmas["rules/windows/builtin/win_user_added_to_local_administrators.yml"] = from x in evnt where ((x.Key == "4732" && (new Regex(@"GroupName.*Administrators", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"GroupSid.*S-1-5-32-544", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"SubjectUserName.*.*$", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/builtin/win_user_creation.yml"] = from x in evnt where x.Key == "4720" select x;
            sigmas["rules/windows/sysmon/sysmon_ads_executable.yml"] = from x in evnt where (x.Key == "15" && !(new Regex(@"Imphash.*00000000000000000000000000000000", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_cmstp_execution.yml"] = from x in evnt where ((x.Key == "12" && new Regex(@"TargetObject.*.*\\cmmgr32.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (x.Key == "13" && new Regex(@"TargetObject.*.*\\cmmgr32.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (x.Key == "10" && new Regex(@"CallTrace.*.*cmlua.dll.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_cmstp_execution_2.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"ParentImage.*.*\\cmstp.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_cobaltstrike_process_injection.yml"] = from x in evnt where (x.Key == "8" && (new Regex(@"TargetProcessAddress.*.*0B80", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetProcessAddress.*.*0C7C", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetProcessAddress.*.*0C88", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_dhcp_calloutdll.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"TargetObject.*.*\\Services\\DHCPServer\\Parameters\\CalloutDlls", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\Services\\DHCPServer\\Parameters\\CalloutEnabled", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_dns_serverlevelplugindll.yml"] = from x in evnt where (x.Key == "13" && new Regex(@"TargetObject.*.*\\services\\DNS\\Parameters\\ServerLevelPluginDll", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_dns_serverlevelplugindll.yml_2"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*dnscmd.exe /config /serverlevelplugindll .*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_ghostpack_safetykatz.yml"] = from x in evnt where (x.Key == "11" && new Regex(@"TargetFilename.*.*\\Temp\\debug.bin", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_logon_scripts_userinitmprlogonscript.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\userinit.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && !(new Regex(@"Image.*.*\\explorer.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"CommandLine.*.*\\netlogon.bat", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_logon_scripts_userinitmprlogonscript_2.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.*UserInitMprLogonScript.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_logon_scripts_userinitmprlogonscript_3.yml"] = from x in evnt where ((x.Key == "11" | x.Key == "12" | x.Key == "13" | x.Key == "14") && new Regex(@"TargetObject.*.*UserInitMprLogonScript.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_lsass_memdump.yml"] = from x in evnt where (x.Key == "10" && new Regex(@"TargetImage.*C:\\windows\\system32\\lsass.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"GrantedAccess.*0x1fffff", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"CallTrace.*.*dbghelp.dll.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CallTrace.*.*dbgcore.dll.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_mal_namedpipes.yml"] = from x in evnt where ((x.Key == "17" | x.Key == "18") && (new Regex(@"PipeName.*\\isapi_http", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\isapi_dg", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\isapi_dg2", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\sdlrpc", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\ahexec", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\winsession", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\lsassw", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\46a676ab7f179e511e30dd2dc41bd388", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\9f81f59bc58452127884ce513865ed20", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\e710f28d59aa529d6792ca6ff0ca1b34", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\rpchlp_3", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\NamePipe_MoreWindows", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\pcheap_reuse", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"PipeName.*\\msagent_.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_malware_backconnect_ports.yml"] = from x in evnt where ((x.Key == "3" && new Regex(@"Initiated.*true", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"DestinationPort.*4443", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*2448", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*8143", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*1777", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*1443", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*243", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*65535", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*13506", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*3360", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*200", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*198", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*49180", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*13507", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*6625", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*4444", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*4438", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*1904", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*13505", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*13504", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*12102", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*9631", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*5445", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*2443", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*777", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*13394", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*13145", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*12103", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*5552", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*3939", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*3675", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*666", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*473", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*5649", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*4455", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*4433", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*1817", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*100", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*65520", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*1960", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*1515", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*743", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*700", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*14154", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*14103", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*14102", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*12322", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*10101", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*7210", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*4040", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationPort.*9943", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !((new Regex(@"Image.*.*\\Program Files.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | ((new Regex(@"DestinationIp.*10..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*192.168..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.16..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.17..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.18..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.19..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.20..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.21..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.22..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.23..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.24..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.25..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.26..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.27..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.28..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.29..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.30..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.31..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*127..*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"DestinationIsIpv6.*false", RegexOptions.IgnoreCase).IsMatch(x.Value))))) select x;
            sigmas["rules/windows/sysmon/sysmon_malware_verclsid_shellcode.yml"] = from x in evnt where ((x.Key == "10" && new Regex(@"TargetImage.*.*\\verclsid.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"GrantedAccess.*0x1FFFFF", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CallTrace.*.*|UNKNOWN\(.*VBE7.DLL.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | (new Regex(@"SourceImage.*.*\\Microsoft Office\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"CallTrace.*.*|UNKNOWN.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_mimikatz_detection_lsass.yml"] = from x in evnt where (x.Key == "10" && new Regex(@"TargetImage.*C:\\windows\\system32\\lsass.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"GrantedAccess.*0x1410", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"GrantedAccess.*0x1010", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_mimikatz_trough_winrm.yml"] = from x in evnt where (x.Key == "10" && new Regex(@"TargetImage.*C:\\windows\\system32\\lsass.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"SourceImage.*C:\\Windows\\system32\\wsmprovhost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_powershell_exploit_scripts.yml"] = from x in evnt where (x.Key == "11" && (new Regex(@"TargetFilename.*.*\\Invoke-DllInjection.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-WmiCommand.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-GPPPassword.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-Keystrokes.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-VaultCredential.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-CredentialInjection.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-Mimikatz.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-NinjaCopy.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-TokenManipulation.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Out-Minidump.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\VolumeShadowCopyTools.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ReflectivePEInjection.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-TimedScreenshot.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-UserHunter.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Find-GPOLocation.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ACLScanner.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-DowngradeAccount.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-ServiceUnquoted.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-ServiceFilePermission.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-ServicePermission.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ServiceAbuse.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Install-ServiceBinary.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-RegAutoLogon.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-VulnAutoRun.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-VulnSchTask.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-UnattendedInstallFile.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-WebConfig.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-ApplicationHost.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-RegAlwaysInstallElevated.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-Unconstrained.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Add-RegBackdoor.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Add-ScrnSaveBackdoor.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Gupt-Backdoor.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ADSBackdoor.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Enabled-DuplicateToken.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PsUaCme.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Remove-Update.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Check-VM.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-LSASecret.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-PassHashes.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Show-TargetScreen.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Port-Scan.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PoshRatHttp.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PowerShellTCP.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PowerShellWMI.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Add-Exfiltration.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Add-Persistence.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Do-Exfiltration.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Start-CaptureServer.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ShellCode.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-ChromeDump.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-ClipboardContents.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-FoxDump.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-IndexedItem.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-Screenshot.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-Inveigh.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-NetRipper.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-EgressCheck.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PostExfil.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PSInject.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-RunAs.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\MailRaider.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\New-HoneyHash.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Set-MacAttribute.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-DCSync.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PowerDump.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Exploit-Jboss.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ThunderStruck.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-VoiceTroll.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Set-Wallpaper.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-InveighRelay.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PsExec.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-SSHCommand.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-SecurityPackages.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Install-SSP.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-BackdoorLNK.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\PowerBreach.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-SiteListPassword.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-System.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-BypassUAC.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-Tater.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-WScriptBypassUAC.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\PowerUp.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\PowerView.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Get-RickAstley.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Find-Fruit.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\HTTP-Login.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Find-TrustedDocuments.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-Paranoia.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-WinEnum.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ARPScan.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-PortScan.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-ReverseDNSLookup.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-SMBScanner.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\Invoke-Mimikittenz.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_powershell_network_connection.yml"] = from x in evnt where ((x.Key == "3" && new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Initiated.*true", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"DestinationIp.*10..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*192.168..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.16..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.17..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.18..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.19..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.20..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.21..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.22..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.23..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.24..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.25..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.26..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.27..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.28..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.29..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.30..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.31..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*127.0.0.1", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"DestinationIsIpv6.*false", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_quarkspw_filedump.yml"] = from x in evnt where (x.Key == "11" && new Regex(@"TargetFilename.*.*\\AppData\\Local\\Temp\\SAM-.*.dmp.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_rdp_reverse_tunnel.yml"] = from x in evnt where (x.Key == "3" && new Regex(@"Image.*.*\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Initiated.*true", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"SourcePort.*3389", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"DestinationIp.*127..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*::1", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_rdp_settings_hijack.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"TargetObject.*.*\\services\\TermService\\Parameters\\ServiceDll.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\Control\\Terminal Server\\fSingleSessionPerUser.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\Control\\Terminal Server\\fDenyTSConnections.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_registry_persistence_key_linking.yml"] = from x in evnt where (x.Key == "12" && new Regex(@"TargetObject.*HKU\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TargetObject.*.*_Classes\\CLSID\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TargetObject.*.*\\TreatAs", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_renamed_powershell.yml"] = from x in evnt where ((new Regex(@"Description.*Windows PowerShell", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Company.*Microsoft Corporation", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Image.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell_ise.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_renamed_procdump.yml"] = from x in evnt where (new Regex(@"OriginalFileName.*procdump", RegexOptions.IgnoreCase).IsMatch(x.Value) && !((new Regex(@"Image.*.*\\procdump.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\procdump64.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_renamed_psexec.yml"] = from x in evnt where ((new Regex(@"Description.*Execute processes remotely", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Product.*Sysinternals PsExec", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Image.*.*\\PsExec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\PsExec64.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_rundll32_net_connections.yml"] = from x in evnt where ((x.Key == "3" && new Regex(@"Image.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Initiated.*true", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"DestinationIp.*10..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*192.168..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.16..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.17..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.18..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.19..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.20..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.21..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.22..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.23..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.24..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.25..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.26..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.27..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.28..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.29..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.30..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*172.31..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationIp.*127..*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_ssp_added_lsa_config.yml"] = from x in evnt where ((x.Key == "13" && (new Regex(@"TargetObject.*HKLM\\System\\CurrentControlSet\\Control\\Lsa\\Security Packages", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*HKLM\\System\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(new Regex(@"Image.*C:\\Windows\\system32\\msiexec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Windows\\syswow64\\MsiExec.exe", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_stickykey_like_backdoor.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"EventType.*SetValue", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_stickykey_like_backdoor_2.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"ParentImage.*.*\\winlogon.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*cmd.exe sethc.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cmd.exe utilman.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cmd.exe osk.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cmd.exe Magnify.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cmd.exe Narrator.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cmd.exe DisplaySwitch.exe .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_download_run_key.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"Image.*.*\\Downloads\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Temporary Internet Files\\Content.Outlook\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Local Settings\\Temporary Internet Files\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_driver_load.yml"] = from x in evnt where (x.Key == "6" && new Regex(@"ImageLoaded.*.*\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_file_characteristics.yml"] = from x in evnt where (new Regex(@"Description.*\\\?", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"FileVersion.*\\\?", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Product.*\\\?", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Company.*\\\?", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_suspicious_keyboard_layout_load.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"TargetObject.*.*\\Keyboard Layout\\Preload\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\Keyboard Layout\\Substitutes\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Details.*00000429", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*00050429", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*0000042a", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_image_load.yml"] = from x in evnt where (x.Key == "7" && (new Regex(@"Image.*.*\\notepad.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"ImageLoaded.*.*\\samlib.dll", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ImageLoaded.*.*\\WinSCard.dll", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_lsass_dll_load.yml"] = from x in evnt where ((x.Key == "12" | x.Key == "13") && (new Regex(@"TargetObject.*.*\\CurrentControlSet\\Services\\NTDS\\DirectoryServiceExtPt.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\CurrentControlSet\\Services\\NTDS\\LsaDbExtPt.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_powershell_rundll32.yml"] = from x in evnt where (x.Key == "8" && new Regex(@"SourceImage.*.*\\powershell.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TargetImage.*.*\\rundll32.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_prog_location_network_connection.yml"] = from x in evnt where (x.Key == "3" && (new Regex(@"Image.*.*\\$Recycle.bin", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\All Users\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\Default\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\Contacts\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Users\\Searches\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*C:\\Perflogs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\config\\systemprofile\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\Fonts\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\IME\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Windows\\addins\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_rdp.yml"] = from x in evnt where ((x.Key == "3" && new Regex(@"DestinationPort.*3389", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"Initiated.*true", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !((new Regex(@"Image.*.*\\mstsc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RTSApp.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RTS2App.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RDCMan.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\ws_TunnelService.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RSSensor.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RemoteDesktopManagerFree.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RemoteDesktopManager.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\RemoteDesktopManager64.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mRemoteNG.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mRemote.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\Terminals.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\spiceworks-finder.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\FSDiscovery.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\FSAssessment.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\MobaRTE.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\chrome.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\thor.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\thor64.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_reg_persist_explorer_run.yml"] = from x in evnt where (x.Key == "13" && new Regex(@"TargetObject.*.*\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"Details.*C:\\Windows\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*C:\\ProgramData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*C:\\$Recycle.bin\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*C:\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*C:\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*C:\\Users\\Default\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_susp_run_key_img_folder.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Details.*.*C:\\Windows\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*\\AppData\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*%AppData%\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*C:\\$Recycle.bin\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*C:\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*C:\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*%Public%\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*C:\\Users\\Default\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*C:\\Users\\Desktop\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*wscript.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*cscript.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/sysmon/sysmon_svchost_dll_search_order_hijack.yml"] = from x in evnt where ((x.Key == "7" && (new Regex(@"Image.*.*\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"ImageLoaded.*.*\\tsmsisrv.dll", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ImageLoaded.*.*\\tsvipsrv.dll", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ImageLoaded.*.*\\wlbsctrl.dll", RegexOptions.IgnoreCase).IsMatch(x.Value))) && !(x.Key == "7" && (new Regex(@"Image.*.*\\svchost.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"ImageLoaded.*C:\\Windows\\WinSxS\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_sysinternals_eula_accepted.yml"] = from x in evnt where (x.Key == "13" && new Regex(@"TargetObject.*.*\\EulaAccepted", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_sysinternals_eula_accepted.yml_2"] = from x in evnt where (x.Key == "1" && new Regex(@"CommandLine.*.* -accepteula.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_tsclient_filewrite_startup.yml"] = from x in evnt where (x.Key == "11" && new Regex(@"Image.*.*\\mstsc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TargetFileName.*.*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_uac_bypass_eventvwr.yml"] = from x in evnt where ((x.Key == "13" && new Regex(@"TargetObject.*HKEY_USERS\\.*\\mscfile\\shell\\open\\command", RegexOptions.IgnoreCase).IsMatch(x.Value)) | ((x.Key == "1" && new Regex(@"ParentImage.*.*\\eventvwr.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"Image.*.*\\mmc.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_uac_bypass_sdclt.yml"] = from x in evnt where (x.Key == "13" && new Regex(@"TargetObject.*HKEY_USERS\\.*\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_webshell_creation_detect.yml"] = from x in evnt where (x.Key == "11" && ((new Regex(@"TargetFilename.*.*\\inetpub\\wwwroot\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"TargetFilename.*.*.asp.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*.ashx.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*.ph.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | ((new Regex(@"TargetFilename.*.*\\www\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\htdocs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFilename.*.*\\html\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"TargetFilename.*.*.ph.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"TargetFilename.*.*\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TargetFilename.*.*.jsp.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | (new Regex(@"TargetFilename.*.*\\cgi-bin\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"TargetFilename.*.*.pl.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/sysmon/sysmon_win_binary_github_com.yml"] = from x in evnt where (x.Key == "3" && new Regex(@"Initiated.*true", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"DestinationHostname.*.*.github.com", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationHostname.*.*.githubusercontent.com", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"Image.*C:\\Windows\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_win_binary_susp_com.yml"] = from x in evnt where (x.Key == "3" && new Regex(@"Initiated.*true", RegexOptions.IgnoreCase).IsMatch(x.Value) && (new Regex(@"DestinationHostname.*.*dl.dropboxusercontent.com", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationHostname.*.*.pastebin.com", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"DestinationHostname.*.*.githubusercontent.com", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"Image.*C:\\Windows\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_win_reg_persistence.yml"] = from x in evnt where (x.Key == "13" && (new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\.*\\GlobalFlag", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\.*\\ReportingMode", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\.*\\MonitorProcess", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"EventType.*SetValue", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_wmi_event_subscription.yml"] = from x in evnt where (x.Key == "19" | x.Key == "20" | x.Key == "21") select x;
            sigmas["rules/windows/sysmon/sysmon_wmi_persistence_commandline_event_consumer.yml"] = from x in evnt where (x.Key == "7" && new Regex(@"Image.*C:\\Windows\\System32\\wbem\\WmiPrvSE.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"ImageLoaded.*wbemcons.dll", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_wmi_persistence_script_event_consumer_write.yml"] = from x in evnt where (x.Key == "11" && new Regex(@"Image.*C:\\WINDOWS\\system32\\wbem\\scrcons.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/sysmon/sysmon_wmi_susp_scripting.yml"] = from x in evnt where (x.Key == "20" && (new Regex(@"Destination.*.*new-object system.net.webclient\).downloadstring\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.*new-object system.net.webclient\).downloadfile\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.*new-object net.webclient\).downloadstring\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.*new-object net.webclient\).downloadfile\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.* iex\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.*WScript.shell.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.* -nop .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.* -noprofile .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.* -decode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Destination.*.* -enc .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/powershell/powershell_data_compressed.yml"] = from x in evnt where (x.Key == "4104" && new Regex(@"keywords.*.*-Recurse.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"keywords.*.*|.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"keywords.*.*Compress-Archive.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_downgrade_attack.yml"] = from x in evnt where ((x.Key == "400" && new Regex(@"EngineVersion.*2..*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"HostVersion.*2..*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/powershell/powershell_exe_calling_ps.yml"] = from x in evnt where (x.Key == "400" && (new Regex(@"EngineVersion.*2..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"EngineVersion.*4..*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"EngineVersion.*5..*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@"HostVersion.*3..*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_malicious_commandlets.yml"] = from x in evnt where ((new Regex(@"Message.*.*Invoke-DllInjection.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-Shellcode.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-WmiCommand.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-GPPPassword.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-Keystrokes.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-TimedScreenshot.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-VaultCredential.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-CredentialInjection.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-Mimikatz.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-NinjaCopy.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-TokenManipulation.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Out-Minidump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*VolumeShadowCopyTools.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-ReflectivePEInjection.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-UserHunter.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Find-GPOLocation.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-ACLScanner.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-DowngradeAccount.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-ServiceUnquoted.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-ServiceFilePermission.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-ServicePermission.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-ServiceAbuse.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Install-ServiceBinary.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-RegAutoLogon.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-VulnAutoRun.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-VulnSchTask.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-UnattendedInstallFile.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-ApplicationHost.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-RegAlwaysInstallElevated.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-Unconstrained.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Add-RegBackdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Add-ScrnSaveBackdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Gupt-Backdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-ADSBackdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Enabled-DuplicateToken.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PsUaCme.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Remove-Update.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Check-VM.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-LSASecret.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-PassHashes.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Show-TargetScreen.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Port-Scan.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PoshRatHttp.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PowerShellTCP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PowerShellWMI.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Add-Exfiltration.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Add-Persistence.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Do-Exfiltration.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Start-CaptureServer.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-ChromeDump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-ClipboardContents.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-FoxDump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-IndexedItem.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-Screenshot.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-Inveigh.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-NetRipper.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-EgressCheck.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PostExfil.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PSInject.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-RunAs.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*MailRaider.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*New-HoneyHash.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Set-MacAttribute.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-DCSync.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PowerDump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Exploit-Jboss.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-ThunderStruck.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-VoiceTroll.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Set-Wallpaper.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-InveighRelay.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PsExec.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-SSHCommand.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-SecurityPackages.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Install-SSP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-BackdoorLNK.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*PowerBreach.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-SiteListPassword.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-System.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-BypassUAC.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-Tater.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-WScriptBypassUAC.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*PowerUp.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*PowerView.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Get-RickAstley.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Find-Fruit.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*HTTP-Login.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Find-TrustedDocuments.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-Paranoia.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-WinEnum.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-ARPScan.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-PortScan.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-ReverseDNSLookup.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-SMBScanner.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Invoke-Mimikittenz.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && !(new Regex(@"Get-SystemDriveInfo", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/powershell/powershell_malicious_keywords.yml"] = from x in evnt where (new Regex(@"Message.*.*AdjustTokenPrivileges.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*IMAGE_NT_OPTIONAL_HDR64_MAGIC.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Microsoft.Win32.UnsafeNativeMethods.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*ReadProcessMemory.Invoke.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*SE_PRIVILEGE_ENABLED.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*LSA_UNICODE_STRING.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*MiniDumpWriteDump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*PAGE_EXECUTE_READ.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*SECURITY_DELEGATION.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_ADJUST_PRIVILEGES.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_ALL_ACCESS.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_ASSIGN_PRIMARY.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_DUPLICATE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_ELEVATION.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_IMPERSONATE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_INFORMATION_CLASS.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_PRIVILEGES.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*TOKEN_QUERY.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Metasploit.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*Mimikatz.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_ntfs_ads_access.yml"] = from x in evnt where (new Regex(@"set-content", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"-stream", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_prompt_credentials.yml"] = from x in evnt where (x.Key == "4104" && (new Regex(@"Message.*.*PromptForCredential.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/powershell/powershell_psattack.yml"] = from x in evnt where (x.Key == "4103" && new Regex(@"PS ATTACK!!!", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_shellcode_b64.yml"] = from x in evnt where ((x.Key == "4104" && new Regex(@".*AAAAYInlM.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@".*OiCAAAAYInlM.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@".*OiJAAAAYInlM.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/powershell/powershell_suspicious_download.yml"] = from x in evnt where (new Regex(@"Message.*.*System.Net.WebClient\).DownloadString\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*system.net.webclient\).downloadfile\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_suspicious_invocation_generic.yml"] = from x in evnt where ((new Regex(@" -enc ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@" -EncodedCommand ", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@" -w hidden ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@" -window hidden ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@" - windowstyle hidden ", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@" -noni ", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@" -noninteractive ", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/powershell/powershell_suspicious_invocation_specific.yml"] = from x in evnt where (new Regex(@"Message.*.* -nop -w hidden -c .* [Convert]::FromBase64String.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* -w hidden -noni -nop -c ""iex\(New-Object.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.* -w hidden -ep bypass -Enc.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*bypass -noprofile -windowstyle hidden \(new-object system.net.webclient\).download.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*iex\(New-Object Net.WebClient\).Download.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_suspicious_keywords.yml"] = from x in evnt where (new Regex(@"Message.*.*[System.Reflection.Assembly]::Load.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/powershell/powershell_winlogon_helper_dll.yml"] = from x in evnt where (x.Key == "4104" && (new Regex(@".*Set-ItemProperty.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@".*New-Item.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && new Regex(@".*CurrentVersion\\Winlogon.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/malware/av_exploiting.yml"] = from x in evnt where (new Regex(@"Signature.*.*MeteTool.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*MPreter.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*Meterpreter.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*Metasploit.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*PowerSploit.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*CobaltSrike.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*Swrort.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*Rozena.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*Backdoor.Cobalt.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/malware/av_password_dumper.yml"] = from x in evnt where (new Regex(@"Signature.*.*DumpCreds.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*Mimikatz.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*PWCrack.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*HTool/WCE", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*PSWtool.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*PWDump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*SecurityTool.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*PShlSpy.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/malware/av_relevant_files.yml"] = from x in evnt where (new Regex(@"FileName.*C:\\Windows\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*C:\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*\\Client\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*C:\\PerfLogs\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*C:\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*C:\\Users\\Default\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.ps1", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.vbs", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.bat", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.chm", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.xml", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.txt", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.jsp", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.jspx", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.asp", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.aspx", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.php", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.war", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.hta", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.lnk", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.scf", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.wsf", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"FileName.*.*.wsh", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/malware/av_webshell.yml"] = from x in evnt where (new Regex(@"Signature.*PHP/Backdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*JSP/Backdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*ASP/Backdoor.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*Backdoor.PHP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*Backdoor.JSP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*Backdoor.ASP.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Signature.*.*Webshell.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/malware/win_mal_ryuk.yml"] = from x in evnt where (x.Key == "1" && (new Regex(@"CommandLine.*.*\\net.exe stop ""samss"" .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\net.exe stop ""audioendpointbuilder"" .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*\\net.exe stop ""unistoresvc_\\?\\?\\?\\?\\?"" .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/malware/win_mal_ursnif.yml"] = from x in evnt where (x.Key == "13" && new Regex(@"TargetObject.*.*\\Software\\AppDataLow\\Software\\Microsoft\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/other/gen_godmode_rule.yml"] = from x in evnt where (x.Key == "1" && ((new Regex(@"CommandLine.*.* -NoP .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -W Hidden .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -decode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /decode .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e.* JAB.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e.* SUVYI.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e.* SQBFAFgA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e.* aWV4I.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -e.* aQBlAHgA.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*vssadmin delete shadows.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*reg SAVE HKLM\\SAM.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* -ma .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*Microsoft\\Windows\\CurrentVersion\\Run.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.downloadstring\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*.downloadfile\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* /ticket:.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* sekurlsa.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.* p::d .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*;iex\(.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*schtasks.* /create .*AppData.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) | ((new Regex(@"ParentImage.*.*\\WINWORD.EXE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\EXCEL.EXE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\POWERPNT.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\MSPUB.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\VISIO.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ParentImage.*.*\\OUTLOOK.EXE.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Image.*.*\\cmd.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\powershell.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wscript.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\cscript.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\schtasks.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\regsvr32.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\hh.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\wmic.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\mshta.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\msiexec.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\forfiles.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | ((new Regex(@"Image.*.*\\apache.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\tomcat.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\w3wp.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\php-cgi.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\nginx.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Image.*.*\\httpd.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"CommandLine.*.*whoami.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*net user .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*ping -n .*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*systeminfo.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*&cd&echo.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"CommandLine.*.*cd /d .*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | (new Regex(@"Image.*.*\\whoami.exe.*", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/other/gen_godmode_rule_2.yml"] = from x in evnt where ((x.Key == "11" && (new Regex(@"TargetFileName.*.*.dmp.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFileName.*.*Desktop\\how.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetFileName.*.*Desktop\\decrypt.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | ((x.Key == "12" | x.Key == "13") && (new Regex(@"TargetObject.*.*UserInitMprLogonScript.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\CurrentVersion\\Image File Execution Options\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | ((x.Key == "12" | x.Key == "13") && (new Regex(@"TargetObject.*.*\\Microsoft\\Windows\\CurrentVersion\\Run\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"TargetObject.*.*\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value)) && (new Regex(@"Details.*.*AppData.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*\\Users\\Public\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*\\Temp\\.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*powershell.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*wscript.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Details.*.*cscript.*", RegexOptions.IgnoreCase).IsMatch(x.Value)))) select x;
            sigmas["rules/windows/other/gen_godmode_rule_3.yml"] = from x in evnt where (x.Key == "7045" && (new Regex(@"ServiceName.*.*WCESERVICE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*.*WCE SERVICE.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*.*winexesvc.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*.*DumpSvc.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*.*pwdump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*.*gsecdump.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"ServiceName.*.*cachedump.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) select x;
            sigmas["rules/windows/other/win_tool_psexec.yml"] = from x in evnt where (new Regex(@"ServiceName.*PSEXESVC", RegexOptions.IgnoreCase).IsMatch(x.Value) && ((x.Key == "7045" && new Regex(@"ServiceFileName.*.*\\PSEXESVC.exe", RegexOptions.IgnoreCase).IsMatch(x.Value)) | x.Key == "7036")) select x;
            sigmas["rules/windows/other/win_tool_psexec_2.yml"] = from x in evnt where (x.Key == "1" && new Regex(@"Image.*.*\\PSEXESVC.exe", RegexOptions.IgnoreCase).IsMatch(x.Value) && new Regex(@"User.*NT AUTHORITY\\SYSTEM", RegexOptions.IgnoreCase).IsMatch(x.Value)) select x;
            sigmas["rules/windows/other/win_wmi_persistence.yml"] = from x in evnt where ((x.Key == "5861" && (new Regex(@"Message.*.*ActiveScriptEventConsumer.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*CommandLineEventConsumer.*", RegexOptions.IgnoreCase).IsMatch(x.Value) | new Regex(@"Message.*.*CommandLineTemplate.*", RegexOptions.IgnoreCase).IsMatch(x.Value))) | x.Key == "5859") select x;




        }
    }
}
